function drawVacations(){$.get("/API/AdminApi/GetPendingVacations").done(function(n){n.Message?$vacationStatus.empty().append("Teil puuduvad \u00f5igused n\u00e4ha pending puhkusi."):$.each(n,function(n,t){var r=dateFormat(new Date(t.StartDate)),u=dateFormat(new Date(t.EndDate)),i=t.Comments;i==null&&(i="");$vacations.append('<tr><td class="name">'+t.EmployeeId+"<\/td><td>"+r+"<\/td><td>"+u+"<\/td><td><p>"+i+'<\/p><\/td><td><input type="submit" class="btn btn-submit" value="Approve" onClick="approveVacation('+t.Id+')"><input type="submit" class="btn btn-submit" value="Decline" onClick="declineVacation('+t.Id+')"><\/td><\/tr>')});setNames()})}function approveVacation(n){$.post("/API/AdminApi/ApproveVacation",{Id:n}).success(function(){$vacations.empty();drawVacations();$confirmedVacations.empty();drawConfirmedVacations();$vacationStatus.empty().append("Tehing on l\u00f5puni viidud")}).error(function(){$vacationStatus.empty().append("Midagi l\u00e4ks Valesti")})}function declineVacation(n){$.post("/API/AdminApi/DeleteVacation",{Id:n}).success(function(){$vacations.empty();drawVacations();$confirmedVacations.empty();drawConfirmedVacations();$vacationStatus.empty().append("Tehing on l\u00f5puni viidud")}).error(function(){$vacationStatus.empty().append("Midagi l\u00e4ks Valesti")})}function drawConfirmedVacations(){$.get("/API/AdminApi/GetConfirmedVacations").done(function(n){n.Message?$confirmedVacationStatus.empty().append("Teil puuduvad \u00f5igused n\u00e4ha confirmed puhkusi."):($.each(n,function(n,t){var r=dateFormat(new Date(t.StartDate)),u=dateFormat(new Date(t.EndDate)),i=t.Comments;i==null&&(i="");$confirmedVacations.append('<tr><td class="name">'+t.EmployeeId+"<\/td><td>"+r+"<\/td><td>"+u+"<\/td><td><p>"+i+'<\/p><\/td><td><input id="Modify'+t.Id+'" value="Modify" data-placement="bottom" data-toggle="popover" data-title="Modify" data-container="body" type="button" data-html="true" class="btn btn-submit modify" onclick=""><input value="Delete" type="button" class="btn btn-submit" onclick="deleteVacation('+t.Id+')"<\/td><\/tr>');popover(t.Id)}),setNames())})}function modifyVacation(n){var t=new Date($("#dpa"+n).data().date),i=new Date($("#dpl"+n).data().date);$.post("/API/AdminApi/ModifyVacation",{Id:n,Start:t.toISOString(),End:i.toISOString()}).success(function(){$("#dpl"+n).removeData();$("#dpa"+n).removeData();hideAllPopovers();isVisible=!1;$confirmedVacations.empty();drawConfirmedVacations();$confirmedVacationStatus.empty().append("Puhkus edukalt muudetud.")}).error(function(){$confirmedVacationStatus.empty().append("Midagi l\u00e4ks valesti.")})}function deleteVacation(n){$.post("/API/AdminApi/DeleteVacation",{Id:n}).success(function(){$confirmedVacations.empty();drawConfirmedVacations();$confirmedVacationStatus.empty().append("Puhkus edukalt kustutatud.")}).error(function(){$confirmedVacationStatus.empty().append("Midagi l\u00e4ks valesti.")})}function popover(n){$("#Modify"+n).popover({html:!0,trigger:"manual",content:formatPopover(n)}).on("click",function(t){isVisible?(hideAllPopovers(),isVisible=!1,t.stopPropagation()):($(this).popover("show"),isVisible=!0,t.stopPropagation(),initDatepicker(["#dpa"+n,"#dpl"+n]))})}function formatPopover(n){return'<form class="form-inline" role="form" class="popover"><div class="form-group"><div class="input-append date" id="dpa'+n+'" data-date="" data-date-format="yyyy-mm-dd"><label for="algus'+n+'">Algus: <\/label><input id="algus'+n+'" class="span2 algus" size="16" type="text" value="" onclick="showDatePicker(&apos;#dpa'+n+'&apos;)"><span class="add-on"><i class="icon-th"><\/i><\/span><\/div><div class="input-append date" id="dpl'+n+'" data-date="" data-date-format="yyyy-mm-dd"><label for="l\u00f5pp'+n+'">L\u00f5pp: <\/label><input id="l\u00f5pp'+n+'" class="span2 l\u00f5pp" size="16" type="text" value="" onclick="showDatePicker(&apos;#dpl'+n+'&apos;)"><span class="add-on"><i class="icon-th"><\/i><\/span><\/div><input type="button" class="btn btn-submit" value="Save" onClick="modifyVacation('+n+')"><\/div><\/form>'}function hideAllPopovers(){$(".modify").each(function(){$(this).popover("hide")});$(".datepicker").each(function(){$(this).remove()})}function showDatePicker(n){$(n).datepicker("show")}function initDatepicker(n){$.each(n,function(n,t){var r=$(t).datepicker({onRender:function(n){return n.valueOf()<now.valueOf()?"disabled":""}}).on("changeDate",function(n){if(n.date.valueOf()>i.date.valueOf()){var u=new Date(n.date);u.setDate(u.getDate()+1);i.setValue(u)}r.hide();$(t)[0].focus()}).data("datepicker"),i=$(t).datepicker({onRender:function(n){return n.valueOf()<=r.date.valueOf()?"disabled":""}}).on("changeDate",function(){i.hide()}).data("datepicker");$(t).datepicker().on("changeDate",function(n){$(t).date=n.date})})}var $vacations=$("#vacationsBody"),$vacationStatus=$("#vacationStatus"),$confirmedVacations=$("#confirmedVacationsBody"),$confirmedVacationStatus=$("#confirmedVacationStatus"),isVisible=!1,date=new Date,now=new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0,0);$(document).ready(function(){drawVacations();drawConfirmedVacations()});